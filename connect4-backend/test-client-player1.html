<!DOCTYPE html>
<html>
<head>
  <title>Player 1 Test</title>
</head>
<body>
<h1>Player 1 - PVP Mode</h1>

<div>
  <button onclick="joinPVP()">Join PVP Game</button>
</div>
<hr>
<div id="gameControls" style="display: none;">
  <button onclick="move(0)">Col 0</button>
  <button onclick="move(1)">Col 1</button>
  <button onclick="move(2)">Col 2</button>
  <button onclick="move(3)">Col 3</button>
  <button onclick="move(4)">Col 4</button>
  <button onclick="move(5)">Col 5</button>
  <button onclick="move(6)">Col 6</button>
</div>

<script src="http://localhost:3000/socket.io/socket.io.js"></script>
<script>
  const socket = io("http://localhost:3000");
  let gameId = null;
  const username = "player1";

  socket.on("waiting_for_opponent", () => {
    console.log("â³ WAITING FOR PVP OPPONENT...");
  });

  socket.on("game_start", (data) => {
    console.log("ðŸŽ® GAME STARTED:", data.gameId);
    console.log("Mode:", data.mode);
    gameId = data.gameId;
    console.table(data.board);
    document.getElementById("gameControls").style.display = "block";
  });

  socket.on("game_update", (data) => {
    console.log("TURN:", data.currentTurn);
    console.table(data.board);
  });

  socket.on("game_over", (data) => {
    console.log("ðŸ† GAME OVER:", data);
    document.getElementById("gameControls").style.display = "none";
  });

  // PHASE 5: Reconnection events
  socket.on("game_resume", (data) => {
    console.log("ðŸ”„ GAME RESUMED:", data.gameId);
    gameId = data.gameId;
    console.table(data.board);
    console.log("Current turn:", data.currentTurn);
    document.getElementById("gameControls").style.display = "block";
  });

  socket.on("opponent_disconnected", ({ username }) => {
    console.log(`âš ï¸ ${username} disconnected. Waiting for reconnect (30s)...`);
  });

  socket.on("opponent_reconnected", ({ username }) => {
    console.log(`âœ… ${username} reconnected. Game continues!`);
  });

  function joinPVP() {
    console.log("Joining PVP game as", username);
    socket.emit("join_game", { username, mode: "PVP" });
  }

  function move(col) {
    if (!gameId) {
      console.warn("Game not started yet");
      return;
    }
    console.log("YOU PLAY:", col);
    socket.emit("make_move", {
      gameId,
      column: col,
      username,
    });
  }
</script>
</body>
</html>
